{# backend/templates/base.html #} {% load static %}
<!DOCTYPE html>
<html lang="ru" class="antialiased">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <title>{% block title %}FinAssist — Панель{% endblock %}</title>

    {# Tailwind CDN for quick dev. In production you will build CSS and serve
    statically. #}
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />

    {# Favicon (optional) #}
    <link rel="icon" href="{% static 'images/favicon.png' %}" />

    {% block head_extra %}{% endblock %}
    <style>
      /* Small helpers to keep UI tidy */
      .container-max {
        max-width: 1100px;
        margin-left: auto;
        margin-right: auto;
      }
    </style>
  </head>
  <body class="bg-gray-50 text-gray-900 min-h-screen font-sans">
    <!-- Top navigation -->
    <header class="bg-white border-b">
      <div class="container-max px-4 py-3 flex items-center justify-between">
        <a href="{% url 'dashboard' %}" class="flex items-center space-x-3">
          <img
            src="{% static 'images/logo-mark.png' %}"
            alt="FinAssist"
            class="h-8 w-8"
          />
          <span class="font-semibold text-lg">FinAssist</span>
        </a>

        <nav class="flex items-center space-x-4 text-sm">
          <a href="{% url 'dashboard' %}" class="hover:text-indigo-600"
            >Дашборд</a
          >
          <a href="{% url 'finances:list' %}" class="hover:text-indigo-600"
            >Финансы</a
          >
          <a href="{% url 'analytics:overview' %}" class="hover:text-indigo-600"
            >Аналитика</a
          >
          <a href="{% url 'import:upload' %}" class="hover:text-indigo-600"
            >Импорт CSV</a
          >
          {% if user.is_authenticated and user.is_staff %}
          <a
            href="{% url 'admin:index' %}"
            class="text-sm px-2 py-1 border rounded hover:bg-gray-100"
            >Админ</a
          >
          {% endif %} {% if user.is_authenticated %}
          <div class="relative group">
            <button
              class="flex items-center space-x-2 px-2 py-1 rounded hover:bg-gray-100"
            >
              <span class="text-sm"
                >{{ user.get_full_name|default:user.username }}</span
              >
              <svg
                class="w-4 h-4 text-gray-500"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 9l-7 7-7-7"
                />
              </svg>
            </button>
            <div
              class="hidden group-hover:block absolute right-0 mt-2 w-48 bg-white border rounded shadow z-20"
            >
              <a
                href="{% url 'accounts:profile' %}"
                class="block px-4 py-2 hover:bg-gray-50"
                >Профиль</a
              >
              <a
                href="{% url 'accounts:settings' %}"
                class="block px-4 py-2 hover:bg-gray-50"
                >Настройки</a
              >
              <form method="post" action="{% url 'logout' %}">
                {% csrf_token %}
                <button
                  type="submit"
                  class="w-full text-left px-4 py-2 hover:bg-gray-50"
                >
                  Выйти
                </button>
              </form>
            </div>
          </div>
          {% else %}
          <a
            href="{% url 'login' %}"
            class="px-3 py-1 border rounded hover:bg-gray-100"
            >Войти</a
          >
          {% endif %}
        </nav>
      </div>
    </header>

    <!-- Page content -->
    <main class="container-max px-4 py-6">
      {# Messages (Django messages) #} {% if messages %}
      <div class="space-y-2">
        {% for message in messages %} {% if message.tags %} {% with
        msgtags=message.tags %}
        <div
          class="rounded-md p-3 text-sm {% if 'error' in msgtags %}bg-red-50 border border-red-200 text-red-800{% elif 'warning' in msgtags %}bg-yellow-50 border border-yellow-200 text-yellow-800{% else %}bg-green-50 border border-green-200 text-green-800{% endif %}"
        >
          {{ message }}
        </div>
        {% endwith %} {% else %}
        <div
          class="rounded-md p-3 bg-blue-50 border border-blue-100 text-blue-800 text-sm"
        >
          {{ message }}
        </div>
        {% endif %} {% endfor %}
      </div>
      {% endif %}

      <div class="mt-4 grid grid-cols-1 lg:grid-cols-4 gap-6">
        <!-- Left column / navigation -->
        <aside class="lg:col-span-1 hidden lg:block">
          <div class="bg-white border rounded p-4 shadow-sm">
            <h3 class="text-sm font-semibold text-gray-700 mb-3">Меню</h3>
            <ul class="space-y-2 text-sm">
              <li>
                <a
                  href="{% url 'dashboard' %}"
                  class="block hover:text-indigo-600"
                  >Обзор</a
                >
              </li>
              <li>
                <a
                  href="{% url 'finances:accounts' %}"
                  class="block hover:text-indigo-600"
                  >Счёта</a
                >
              </li>
              <li>
                <a
                  href="{% url 'finances:transactions' %}"
                  class="block hover:text-indigo-600"
                  >Транзации</a
                >
              </li>
              <li>
                <a
                  href="{% url 'analytics:overview' %}"
                  class="block hover:text-indigo-600"
                  >Аналитика</a
                >
              </li>
              <li>
                <a
                  href="{% url 'goals:list' %}"
                  class="block hover:text-indigo-600"
                  >Цели</a
                >
              </li>
              <li>
                <a
                  href="{% url 'settings:notifications' %}"
                  class="block hover:text-indigo-600"
                  >Уведомления</a
                >
              </li>
            </ul>
          </div>
        </aside>

        <!-- Main content -->
        <section class="lg:col-span-3">
          {% block page_header %}
          <!-- Optional page header -->
          <div class="flex items-center justify-between mb-4">
            <h1 class="text-2xl font-semibold text-gray-800">
              {% block header_title %}Панель{% endblock %}
            </h1>
            {% block header_actions %}{% endblock %}
          </div>
          {% endblock %}

          <div class="bg-white border rounded p-6 shadow-sm">
            {% block content %}
            <!-- Page content goes here -->
            <p class="text-sm text-gray-600">
              Добро пожаловать в FinAssist — ваш финансовый помощник.
            </p>
            {% endblock %}
          </div>
        </section>
      </div>
    </main>

    <footer class="mt-8 border-t bg-white">
      <div
        class="container-max px-4 py-4 text-xs text-gray-500 flex items-center justify-between"
      >
        <div>© {{ now|date:"Y" }} FinAssist</div>
        <div class="space-x-4">
          <a href="{% url 'docs:architecture' %}" class="hover:text-indigo-600"
            >Архитектура</a
          >
          <a href="{% url 'privacy' %}" class="hover:text-indigo-600"
            >Политика конфиденциальности</a
          >
          <a href="{% url 'tos' %}" class="hover:text-indigo-600">Условия</a>
        </div>
      </div>
    </footer>

    {# JS libraries: HTMX for progressive enhancement, Chart.js for charts #}
    <script src="https://unpkg.com/htmx.org@1.9.2"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>

    {# Provide a small global helper for rendering flash alerts from HTMX
    responses #}
    <script>
      // Insert flash messages returned in htmx responses to the top of main container.
      (function () {
        document.body.addEventListener("htmx:afterSwap", function (evt) {
          // if server returned a fragment with data-flash attribute, we assume it contains messages
          // No-op here; specific views can include message fragments.
        });
      })();
    </script>

    {% block scripts %}{% endblock %}
  </body>
</html>
